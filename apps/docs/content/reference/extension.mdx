# VS Code Extension

Mind Palace is a minimal VS Code extension providing status bar integration and LSP diagnostics.

---

## Install

1. Install CLI first (required):
   ```sh
   curl -L https://github.com/mehmetkoksal-w/mind-palace/releases/latest/download/palace-darwin-arm64 -o palace
   chmod +x palace && sudo mv palace /usr/local/bin/
   ```

2. Install extension from VS Code Marketplace: "Mind Palace"

---

## Features

### Status Bar

The extension shows Mind Palace status in the VS Code status bar:

| State | Display | Meaning |
|-------|---------|---------|
| Fresh | `✓ Palace 2D/1I/3L` | Index is fresh, shows knowledge counts |
| Stale | `⚠ Palace` | Files changed since last scan |
| Not initialized | `ℹ Palace: Not initialized` | Run `palace init` |
| Error | `⚠ Palace: Error` | Check tooltip for details |

Click the status bar item to refresh status.

### LSP Integration

The extension includes a Language Server Protocol client that provides real-time feedback:

- **Pattern Diagnostics**: Warnings for code deviating from detected patterns
- **Contract Diagnostics**: Errors for frontend/backend API mismatches
- **Hover Information**: Pattern and contract details on hover
- **Code Actions**: Quick fixes to approve, ignore, or verify issues
- **Code Lens**: Issue counts shown at file top and inline

See [LSP Server](/reference/lsp) for complete documentation.

---

## Commands

| Command | Description |
|---------|-------------|
| `mindPalace.checkStatus` | Refresh status bar |
| `mindPalace.restartLsp` | Restart LSP server |

---

## Configuration

### VS Code Settings

```json
{
  "mindPalace.binaryPath": "palace",
  "mindPalace.showStatusBarItem": true,
  "mindPalace.lsp.enabled": true,
  "mindPalace.lsp.diagnostics.patterns": true,
  "mindPalace.lsp.diagnostics.contracts": true,
  "mindPalace.lsp.codeLens.enabled": true
}
```

| Setting | Default | Description |
|---------|---------|-------------|
| `binaryPath` | `"palace"` | Path to palace CLI executable |
| `showStatusBarItem` | `true` | Show status bar indicator |
| `lsp.enabled` | `true` | Enable LSP server for diagnostics |
| `lsp.diagnostics.patterns` | `true` | Show pattern violation diagnostics |
| `lsp.diagnostics.contracts` | `true` | Show contract mismatch diagnostics |
| `lsp.codeLens.enabled` | `true` | Show code lens for issue counts |

---

## Architecture

```
┌─────────────────────────────────────────────────────────────┐
│                    VS CODE EXTENSION                         │
│  ┌───────────┐  ┌────────────┐                              │
│  │ StatusBar │  │ LSP Client │                              │
│  └─────┬─────┘  └──────┬─────┘                              │
│        │               │                                     │
│  ┌─────▼───────────────▼─────┐                              │
│  │         Bridge            │                              │
│  │    (CLI exec wrapper)     │                              │
│  └───────────┬───────────────┘                              │
└──────────────┼──────────────────────────────────────────────┘
               │ exec / stdio
        ┌──────▼──────┐
        │   palace    │
        │    CLI      │
        └─────────────┘
```

**Key principle**: Extension has no state. CLI is source of truth.

---

## Troubleshooting

**"Palace binary not found"**
- Check: `palace version`
- Set `mindPalace.binaryPath` to absolute path

**Status bar shows error**
- Check tooltip for error message
- Run `palace init` if not initialized
- Run `palace index scan` if stale

**LSP not working**
- Check Output panel → "Mind Palace LSP"
- Run `Mind Palace: Restart LSP Server` command
- Verify `palace lsp` works from terminal
